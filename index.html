      // Monats√ºbersicht und Differenz zu Soll
      function updateMonthlyOverview(todayNetto = null) {
        const sollMonat = sollInput.value * 60;

        // Summe
        let istMin = 0;

        // Live heute (falls erfasst)
        const liveStart = localStorage.getItem("liveStart");
        if (liveStart && todayNetto !== null) {
          istMin += todayNetto;
        }

        // Einzelne Tage (Nachtrag)
        const extras = JSON.parse(localStorage.getItem("pastHours") || "{}");
        for (const d in extras) {
          istMin += extras[d];
        }

        // Summierte Wochenbl√∂cke (Nachtrag)
        const sums = JSON.parse(localStorage.getItem("pastSumHours") || "{}");
        for (const d in sums) {
          istMin += sums[d];
        }

        monthlyEl.innerHTML =
          `üìÖ <b>${(new Date()).toLocaleDateString("de-DE", { month: "long", year: "numeric" })}</b><br>` +
          `Monatliches Soll: <b>${fmt(sollMonat)}</b><br>` +
          `Gearbeitet: <b>${fmt(istMin)}</b>`;

        const saldoMonat = istMin - sollMonat;

        hinweisEl.innerHTML =
          `Differenz: <span style="font-weight:bold; color:${saldoMonat>=0?"#177a26":"#be2134"};">${saldoMonat>=0?"+":"‚Äì"}${fmt(Math.abs(saldoMonat))}</span> Stunde${Math.abs(saldoMonat)!==60?"n":""} ${saldoMonat>=0?"‚¨ÜÔ∏è √úberstunden":"‚¨áÔ∏è Minus"}`;
      }

      // √úbersicht: Nur Nachtr√§ge!
      function renderHistory() {
        const extras = JSON.parse(localStorage.getItem("pastHours") || "{}");
        const sums = JSON.parse(localStorage.getItem("pastSumHours") || "{}");

        let html = "";
        if (Object.keys(extras).length) {
          html += "<b>Nachgetragene Einzeltage</b><ul>";
          for (const d of Object.keys(extras).sort()) html += `<li>${d}: ${fmt(extras[d])}</li>`;
          html += "</ul>";
        }
        if (Object.keys(sums).length) {
          html += "<b>Nachgetragene Summen (Wochenbl√∂cke o.√Ñ.)</b><ul>";
          for (const d of Object.keys(sums).sort()) html += `<li>${d.replace("Summe_","Summe ")}: ${fmt(sums[d])}</li>`;
          html += "</ul>";
        }
        historyEl.innerHTML = html || "Noch keine Nachtr√§ge.";
      }

      // Export / Reset
      function exportData() {
        const data = {
          pastHours: JSON.parse(localStorage.getItem("pastHours") || "{}"),
          pastSumHours: JSON.parse(localStorage.getItem("pastSumHours") || "{}"),
          sollstunden: localStorage.getItem("sollstunden")
        };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "feierabend-timer.json";
        a.click();
        URL.revokeObjectURL(url);
      }
      function resetAll() {
        if (confirm("Alle Eintr√§ge wirklich l√∂schen?")) {
          localStorage.removeItem("liveStart");
          localStorage.removeItem("pastHours");
          localStorage.removeItem("pastSumHours");
          // localStorage.removeItem("sollstunden");
          $("startTime").value = "";
          renderHistory();
          updateMonthlyOverview();
          outputEl.innerHTML = "";
          hinweisEl.innerHTML = "";
        }
      }
    })();
